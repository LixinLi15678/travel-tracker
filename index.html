<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>旅行足迹 - Travel Tracker</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">

  <!-- 主CSS -->
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/map.css">

  <link rel="icon" href="assets/images/favicon.png" type="image/png" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
  />
</head>
<body>

  <!-- 侧边栏 -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-close" id="sidebarCloseBtn">
      <i class="fas fa-times"></i> 关闭
    </div>
    <div class="profile-section">
      <!-- 若有头像可加，这里略 -->
      <h3 id="username">未登录</h3>
      <button id="loginOpenBtn">登录 / 注册</button>
    </div>
    <ul class="menu-list">
      <li><a href="#hero-section">首页</a></li>
      <li><a href="#map-section">地图</a></li>
      <li><a href="#visited-section">已访问</a></li>
      <li><a href="#travel-planner-section">旅行计划</a></li>
    </ul>
    <div class="footer-section">
      <p>© 2024 Travel Tracker</p>
    </div>
  </aside>

  <!-- 顶部 -->
  <header class="app-header">
    <div class="logo">
      <img src="assets/images/logo.png" alt="App Logo">
      <h1>旅行足迹</h1>
    </div>
    <nav class="nav-bar">
      <ul>
        <li><a href="#hero-section">首页</a></li>
        <li><a href="#map-section">地图</a></li>
        <li><a href="#visited-section">已访问</a></li>
        <li><a href="#travel-planner-section">旅行计划</a></li>
      </ul>
    </nav>

    <!-- 登录按钮(或已登录状态) -->
    <div class="auth-button-wrapper">
      <button id="loginOpenBtnHeader">登录 / 注册</button>
    </div>

    <div class="mobile-menu-icon" id="mobileMenuBtn">
      <i class="fas fa-bars"></i>
    </div>
  </header>

  <!-- 登录 & 注册弹窗 -->
  <div class="modal" id="authModal">
    <div class="modal-content">
      <span class="close-modal" id="authCloseBtn">&times;</span>
      <div class="tabs">
        <button class="tablink active" data-target="#loginTab">登录</button>
        <button class="tablink" data-target="#registerTab">注册</button>
      </div>
      <div class="tab-content active" id="loginTab">
        <h2>登录</h2>
        <form id="loginForm">
          <div class="form-group">
            <label for="loginUsername">用户名：</label>
            <input type="text" id="loginUsername" name="loginUsername" required>
          </div>
          <button type="submit">登录</button>
        </form>
      </div>
      <div class="tab-content" id="registerTab">
        <h2>注册</h2>
        <form id="registerForm">
          <div class="form-group">
            <label for="registerUsername">用户名：</label>
            <input type="text" id="registerUsername" name="registerUsername" required>
          </div>
          <button type="submit">注册</button>
        </form>
      </div>
    </div>
  </div>

  <main>
    <!-- 英雄区 -->
    <section class="hero-section" id="hero-section">
      <h2>记录你的全球足迹</h2>
      <p>随时随地查看你去过的国家与城市，规划你的下一次旅行！</p>
      <button id="startTrackingBtn">开始记录</button>
    </section>

    <!-- 地图区 -->
    <section id="map-section" class="map-section">
      <h2>探索地图</h2>
      <div id="map"></div>
    </section>

    <!-- 访问记录 -->
    <section id="visited-section" class="visited-section">
      <h2>我的旅行记录</h2>
      <div style="margin-bottom:1rem;">
        <label for="filterYear">按年份筛选：</label>
        <input type="number" id="filterYear" placeholder="如：2019">
        <button id="filterYearBtn">筛选</button>
        <button id="showAllBtn">显示全部</button>
    
        <button id="viewVisitListBtn">查看访问列表</button>
      </div>
      <p id="visitedStats"></p>
      <ul id="visitedList"></ul>

      <!-- 下面两行是新加的：颜色选择器 & 绘制连线按钮 -->
      <div style="margin-top:1rem;">
        <label for="lineColor">连线颜色：</label>
        <input type="color" id="lineColor" value="#ff0000" style="vertical-align: middle;">
      
        <label for="lineWeight" style="margin-left: 1rem;">线宽：</label>
        <input type="number" id="lineWeight" value="3" style="width: 50px; vertical-align: middle;">
      
        <button id="drawLinesBtn">绘制连线</button>
        <button id="clearLinesBtn">清除连线</button>
      </div>
    </section>
    
    <!-- 查看访问列表的模态框 -->
    <div class="modal" id="visitListModal">
      <div class="modal-content">
        <span class="close-modal" id="visitListCloseBtn">&times;</span>
        <h2>访问列表</h2>
    
        <!-- 排序下拉，可选“访问顺序”“国家”“城市” -->
        <div style="margin-bottom:1rem;">
          <label for="visitSortSelect">排序方式：</label>
          <select id="visitSortSelect">
            <option value="time">按访问顺序</option>
            <option value="country">按国家名</option>
            <option value="city">按城市名</option>
          </select>
        </div>
    
        <!-- 在这里渲染详细的访问数据 -->
        <div id="visitListDetail"></div>
      </div>
    </div>    

    <!-- 旅行计划 -->
    <section id="travel-planner-section" class="travel-planner-section">
      <h2>我的旅行计划</h2>
      <form id="travelPlanForm">
        <!-- 国家 -->
        <div class="form-group">
          <label for="plannedCountry">国家：</label>
          <input
            type="text"
            id="plannedCountry"
            name="plannedCountry"
            list="countryList"
            placeholder="如：中国 / 美国"
            required
          >
          <datalist id="countryList"></datalist>
        </div>

        <!-- 城市 -->
        <div class="form-group">
          <label for="plannedCity">城市：</label>
          <div class="autocomplete-wrapper">
            <input
              type="text"
              id="plannedCity"
              name="plannedCity"
              placeholder="如：北京 / 纽约"
              autocomplete="off"
              required
            >
            <ul id="citySearchList" class="search-list"></ul>
          </div>
          <input type="hidden" id="plannedLat">
          <input type="hidden" id="plannedLng">
        </div>

        <div class="form-group">
          <label for="plannedYear">年份：</label>
          <input
            type="number"
            id="plannedYear"
            name="plannedYear"
            placeholder="如：2024"
            step="1"
            min="1900"
            max="2100"
            required
          >
        </div>
        <button type="submit">添加到我的旅行计划</button>
      </form>
      <ul id="travelPlanList"></ul>
    </section>
  </main>

  <footer class="app-footer">
    <p>© 2024 旅行足迹 Travel Tracker. All Rights Reserved.</p>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- 你的脚本 -->
  <script src="scripts/geo.js"></script>
  <script src="scripts/countries.js"></script>
  <script src="scripts/data.js"></script>
  <script src="scripts/main.js"></script>
  <script src="scripts/map.js"></script>

</body>
</html>